{
  "name": "compass",  
  // Use docker while docker-compose doesn't support --gpus
  "dockerFile": "devcontainer.dockerfile",
  "context": "..",  
  "workspaceMount": "type=bind,source=${localWorkspaceFolder},target=/workspace",
  "workspaceFolder": "/workspace",
  "mounts": [
    "type=bind,source=${localEnv:HOME}${localEnv:USERPROFILE}/.ssh,target=/home/user/.ssh",
    "type=bind,source=${localEnv:HOME}${localEnv:USERPROFILE}/.gitconfig,target=/home/user/.gitconfig",
    "type=volume,source=compass_vscode-server,target=/home/user/.vscode-server",
    "type=volume,source=home-cache,target=/home/user/.cache"
  ],
  "extensions": [
    "ms-python.python",
    "VisualStudioExptTeam.vscodeintellicode",
    "GitHub.vscode-pull-request-github",
    "eamodio.gitlens",
    "mhutchie.git-graph",
    "jnoortheen.xonsh"
  ],
  "postCreateCommand": "bash -c '(conda env list | grep ^compass) || (make conda && source activate compass && make install)'",
  "settings": {
    // Save
    "files.autoSave": "afterDelay",
    // Format
    // "editor.formatOnSave": true,
    "editor.detectIndentation": false,
    "editor.tabSize": 4,
    "editor.insertSpaces": true,
    // Ignore files
    "files.exclude": {
      "**/.git": true,
      "**/.ipynb_checkpoints": true,
    },
    // Ignore for watching
    "files.watcherExclude": {
      "**/.git/**": true,
      "**/data/**": true,
      "**/compass.egg-info/**": true,
    },
    // Python
    "python.defaultInterpreterPath": "/workspace/.conda/envs/compass/bin/python",
    "python.terminal.activateEnvInCurrentTerminal": true,
    "python.formatting.provider": "black",
    // pytest
    "python.testing.pytestArgs": [
        "tests"
    ],
    "python.testing.unittestEnabled": false,
    "python.testing.nosetestsEnabled": false,
    "python.testing.pytestEnabled": true,
    // Bandit
    "python.linting.banditEnabled": true,
    // Xonsh
    "terminal.integrated.profiles.linux": {
        "xonsh": {
            "path": "/workspace/.conda/envs/compass/bin/xonsh"
        }
    },
    "terminal.integrated.defaultProfile.linux": "xonsh",
    "pylsp.executable": "/workspace/.conda/envs/compass/bin/pylsp"
  }
}